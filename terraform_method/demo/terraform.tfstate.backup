{
  "version": 4,
  "terraform_version": "1.7.2",
  "serial": 1,
  "lineage": "7742037e-3095-b126-f091-2c70d43600e8",
  "outputs": {},
  "resources": [
    {
      "mode": "managed",
      "type": "sysdig_secure_rule_falco",
      "name": "example",
      "provider": "provider[\"registry.terraform.io/sysdiglabs/sysdig\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "append": false,
            "condition": "spawned_process and container and shell_procs and proc.tty != 0 and container_entrypoint",
            "description": "A shell was used as the entrypoint/exec point into a container with an attached terminal.",
            "exceptions": [
              {
                "comps": [
                  "in"
                ],
                "fields": [
                  "proc.name"
                ],
                "name": "proc_names",
                "values": "[[[\"python\",\"python2\",\"python3\"]]]"
              },
              {
                "comps": [
                  "=",
                  "in"
                ],
                "fields": [
                  "container.id",
                  "proc.name"
                ],
                "name": "container_proc_name",
                "values": "[[\"host\",[\"docker_binaries\",\"k8s_binaries\",\"lxd_binaries\",\"nsenter\"]]]"
              },
              {
                "comps": [
                  "in",
                  "contains"
                ],
                "fields": [
                  "proc.name",
                  "proc.cmdline"
                ],
                "name": "proc_cmdline",
                "values": "[[[\"python\",\"python2\",\"python3\"],\"/opt/draios/bin/sdchecks\"],[[\"java\"],\"sdjagent.jar\"]]"
              }
            ],
            "id": "10192269",
            "minimum_engine_version": null,
            "name": "[Terraform] Terminal shell in container",
            "output": "A shell was spawned in a container with an attached terminal (user=%user.name %container.info shell=%proc.name parent=%proc.pname cmdline=%proc.cmdline terminal=%proc.tty container_id=%container.id image=%container.image.repository)",
            "priority": "notice",
            "source": "syscall",
            "tags": [
              "container",
              "shell",
              "mitre_execution"
            ],
            "timeouts": null,
            "version": 1
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJyZWFkIjozMDAwMDAwMDAwMDAsInVwZGF0ZSI6MzAwMDAwMDAwMDAwfX0="
        }
      ]
    }
  ],
  "check_results": null
}
